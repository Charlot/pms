<% content_for :javascript_includes do %>
    <%= javascript_include_tag "printer" %>
<% end %>

<div class="digg_pagination">
  <div class="page_info">
    <%= page_entries_info @kanbans %>
  </div>
  <%= will_paginate @kanbans, :container => false %>
</div>

<table class="table table-bordered table-striped table-hover">
  <thead>
  <tr>
    <th>#</th>
    <th><%= KanbanDesc::NR %></th>
    <th><%= KanbanDesc::TYPE %></th>
    <th><%= KanbanDesc::WIRE_NR %></th>
    <th><%= KanbanDesc::PRODUCT_NR %></th>
    <th>卡量</th>
    <th>捆扎数</th>
    <th>步骤</th>
    <th><%= KanbanDesc::TASK_TIME %></th>
    <th><%= KanbanDesc::PRINT_DATE %></th>
    <th><%= KanbanDesc::STATE %></th>
    <th><%= KanbanDesc::SOURCE_POSITION %></th>
    <th><%= KanbanDesc::DES_POSITION %></th>
    <th>历史</th>
    <th colspan="2"></th>
  </tr>
  </thead>

  <tbody>
  <% @kanbans.each_with_index do |kanban, index| %>
      <tr>
        <td><%= index + 1 %></td>
        <td><%= kanban.nr %> , <%= kanban.printed_2DCode%></td>
        <td><%= KanbanType.display(kanban.ktype) %></td>
        <td><%= kanban.wire_nr %></td>
        <td><%= kanban.product_nr %></td>
        <td>
          <%= best_in_place kanban, :quantity, as: :input%>
        </td>
        <td>
          <%= best_in_place kanban, :bundle, as: :input%>
        </td>
        <td><%= kanban.process_list%></td>
        <td><%= kanban.task_time %></td>
        <td><%= kanban.print_time %></td>
        <td>
          <span class="label <%= kanban_states_class(kanban.state) %>"><%= KanbanState.display(kanban.state) %></span>
        </td>
        <td><%= "#{kanban.source_warehouse} | #{kanban.source_storage}" %></td>
        <td><%= "#{kanban.des_warehouse} | #{kanban.des_storage}" %></td>
        <td><%= link_to '修改历史', history_kanban_path(kanban) %></td>
        <td><%= link_to '详细', kanban, class: "btn btn-default" %></td>
        <td><%= link_to '编辑', edit_kanban_path(kanban), class: "btn btn-default" %></td>
      </tr>
  <% end %>
  </tbody>
</table>

<div class="digg_pagination">
  <%= will_paginate @kanbans, :container => false %>
</div>